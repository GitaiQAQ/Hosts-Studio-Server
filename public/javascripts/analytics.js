void function(e){var t="0.0.1";var n=e.AV||{};e.AV=n;if(typeof define==="function"&&define.amd){define("AV",[],function(){return n})}var o={};var a={};var i=function(e){var t=e.appId;var n=e.appKey;var i=e.version||null;var r=e.channel||null;return{send:function(e,s){var u=[];if(e&&e.length){u=e}else{if(!e||!e.event){throw"EventObject must have a event value."}var c={event:e.event,attr:e.attr,duration:e.duration,tag:e.tag};u.push(c)}for(var p=0,f=u.length;p<f;p++){u[p].attributes=u[p].attr;delete u[p].attr}var d="https://api.leancloud.cn/1.1/stats/open/collect";var l={client:{id:a.getId(),platform:"web",app_version:i,app_channel:r},session:{id:o.getId()},events:u};o.ajax({url:d,method:"post",data:l,appId:t,appKey:n},function(e,t){if(s){if(e){s(e)}else{s(t)}}})}}};n.analytics=function(e){if(typeof e!=="object"){throw"AV.analytics need a argument at least."}else if(!e.appId){throw"Options must have appId."}else if(!e.appKey){throw"Options must have appKey."}var t=i(e);a.pageView(t);a.sessionView(t);return t};n.analytics.version=t;n.analytics._tool=o;n.analytics._engine=a;a.getId=function(){var t="leancloud-analytics-id";var n=e.localStorage.getItem(t);if(!n){n=o.getId();e.localStorage.setItem(t,n)}return n};a.pageView=function(t){var n;var a;var i;function r(){n=o.now();i=e.location.href}function s(){a=o.now();t.send({event:"_page",duration:a-n,tag:i})}r();e.addEventListener("hashchange",function(e){s();r()});e.addEventListener("beforeunload",function(){s()})};a.sessionView=function(t){var n=o.now();e.addEventListener("beforeunload",function(){var e=o.now();t.send({event:"_session.close",duration:e-n})})};o.getId=function(){var e=function(){return(new Date).getTime().toString(36)+Math.random().toString(36).substring(2,3)};return"AV"+e()+e()+e()};o.ajax=function(e,t){var n=e.url;var o=e.method||"get";var a=new XMLHttpRequest;a.open(o,n);if(o==="post"||o==="put"){a.setRequestHeader("Content-Type","application/json")}if(e.appId){a.setRequestHeader("X-AVOSCloud-Application-Id",e.appId)}if(e.appKey){a.setRequestHeader("X-AVOSCloud-Application-Key",e.appKey)}a.onload=function(e){if(a.status>=200&&a.status<300){t(JSON.parse(a.responseText))}else{t(null,JSON.parse(a.responseText))}};a.onerror=function(e){t(null,e);throw"Network error."};a.send(JSON.stringify(e.data))};o.now=function(){return(new Date).getTime()}}(window);