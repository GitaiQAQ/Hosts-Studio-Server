{"version":3,"sources":["javascripts/analytics.js"],"names":["e","t","n","AV","define","amd","o","a","i","appId","appKey","version","r","channel","send","s","u","length","event","c","attr","duration","tag","push","p","f","attributes","d","l","client","id","getId","platform","app_version","app_channel","session","events","ajax","url","method","data","analytics","pageView","sessionView","_tool","_engine","localStorage","getItem","setItem","now","location","href","addEventListener","Date","getTime","toString","Math","random","substring","XMLHttpRequest","open","setRequestHeader","onload","status","JSON","parse","responseText","onerror","stringify","window"],"mappings":"IAAK,UAASA,GAAG,GAAIC,GAAE,QAAYC,EAAEF,EAAEG,MAAOH,GAAEG,GAAGD,EAAqB,kBAATE,SAAqBA,OAAOC,KAAKD,OAAO,QAAQ,WAAW,MAAOF,IAAI,IAAII,MAASC,KAASC,EAAE,SAASR,GAAG,GAAIC,GAAED,EAAES,MAAUP,EAAEF,EAAEU,OAAWF,EAAER,EAAEW,SAAS,KAASC,EAAEZ,EAAEa,SAAS,IAAK,QAAOC,KAAK,SAASd,EAAEe,GAAG,GAAIC,KAAK,IAAGhB,GAAGA,EAAEiB,OAAQD,EAAEhB,MAAM,CAAC,IAAIA,IAAIA,EAAEkB,MAAO,KAAK,sCAAuC,IAAIC,IAAGD,MAAMlB,EAAEkB,MAAME,KAAKpB,EAAEoB,KAAKC,SAASrB,EAAEqB,SAASC,IAAItB,EAAEsB,IAAKN,GAAEO,KAAKJ,GAAG,IAAI,GAAIK,GAAE,EAAEC,EAAET,EAAEC,OAASQ,EAAFD,EAAIA,IAAKR,EAAEQ,GAAGE,WAAWV,EAAEQ,GAAGJ,WAAYJ,GAAEQ,GAAGJ,IAAK,IAAIO,GAAE,kDAAsDC,GAAGC,QAAQC,GAAGvB,EAAEwB,QAAQC,SAAS,MAAMC,YAAYzB,EAAE0B,YAAYtB,GAAGuB,SAASL,GAAGxB,EAAEyB,SAASK,OAAOpB,EAAGV,GAAE+B,MAAMC,IAAIX,EAAEY,OAAO,OAAOC,KAAKZ,EAAEnB,MAAMR,EAAES,OAAOR,GAAG,SAASF,EAAEC,GAAMc,GAASA,EAAHf,EAAKA,EAAUC,OAAUC,GAAEuC,UAAU,SAASzC,GAAG,GAAc,gBAAJA,GAAc,KAAK,wCAA8C,KAAIA,EAAES,MAAO,KAAK,0BAAgC,KAAIT,EAAEU,OAAQ,KAAK,2BAA4B,IAAIT,GAAEO,EAAER,EAAkC,OAA/BO,GAAEmC,SAASzC,GAAGM,EAAEoC,YAAY1C,GAAUA,GAAGC,EAAEuC,UAAU9B,QAAQV,EAAEC,EAAEuC,UAAUG,MAAMtC,EAAEJ,EAAEuC,UAAUI,QAAQtC,EAAEA,EAAEwB,MAAM,WAAW,GAAI9B,GAAE,yBAA6BC,EAAEF,EAAE8C,aAAaC,QAAQ9C,EAAkD,OAA3CC,KAAGA,EAAEI,EAAEyB,QAAQ/B,EAAE8C,aAAaE,QAAQ/C,EAAEC,IAAUA,GAAGK,EAAEmC,SAAS,SAASzC,GAAqB,QAASW,KAAIV,EAAEI,EAAE2C,MAAMzC,EAAER,EAAEkD,SAASC,KAAK,QAASpC,KAAIR,EAAED,EAAE2C,MAAMhD,EAAEa,MAAMI,MAAM,QAAQG,SAASd,EAAEL,EAAEoB,IAAId,IAAzH,GAAIN,GAAMK,EAAMC,CAA6GI,KAAIZ,EAAEoD,iBAAiB,aAAa,SAASpD,GAAGe,IAAIH,MAAMZ,EAAEoD,iBAAiB,eAAe,WAAWrC,OAAOR,EAAEoC,YAAY,SAAS1C,GAAG,GAAIC,GAAEI,EAAE2C,KAAMjD,GAAEoD,iBAAiB,eAAe,WAAW,GAAIpD,GAAEM,EAAE2C,KAAMhD,GAAEa,MAAMI,MAAM,iBAAiBG,SAASrB,EAAEE,OAAOI,EAAEyB,MAAM,WAAW,GAAI/B,GAAE,WAAW,OAAM,GAAKqD,OAAMC,UAAUC,SAAS,IAAIC,KAAKC,SAASF,SAAS,IAAIG,UAAU,EAAE,GAAI,OAAM,KAAK1D,IAAIA,IAAIA,KAAKM,EAAE+B,KAAK,SAASrC,EAAEC,GAAG,GAAIC,GAAEF,EAAEsC,IAAQhC,EAAEN,EAAEuC,QAAQ,MAAUhC,EAAE,GAAIoD,eAAepD,GAAEqD,KAAKtD,EAAEJ,IAAU,SAAJI,GAAgB,QAAJA,IAAWC,EAAEsD,iBAAiB,eAAe,oBAAuB7D,EAAES,OAAOF,EAAEsD,iBAAiB,6BAA6B7D,EAAES,OAAUT,EAAEU,QAAQH,EAAEsD,iBAAiB,8BAA8B7D,EAAEU,QAAQH,EAAEuD,OAAO,SAAS9D,GAAMO,EAAEwD,QAAQ,KAAKxD,EAAEwD,OAAO,IAAK9D,EAAE+D,KAAKC,MAAM1D,EAAE2D,eAAoBjE,EAAE,KAAK+D,KAAKC,MAAM1D,EAAE2D,gBAAiB3D,EAAE4D,QAAQ,SAASnE,GAAa,KAAVC,GAAE,KAAKD,GAAQ,kBAAkBO,EAAEO,KAAKkD,KAAKI,UAAUpE,EAAEwC,QAAQlC,EAAE2C,IAAI,WAAW,OAAM,GAAKI,OAAMC,YAAYe","file":"javascripts/analytics.js","sourcesContent":["void function(e){var t=\"0.0.1\";var n=e.AV||{};e.AV=n;if(typeof define===\"function\"&&define.amd){define(\"AV\",[],function(){return n})}var o={};var a={};var i=function(e){var t=e.appId;var n=e.appKey;var i=e.version||null;var r=e.channel||null;return{send:function(e,s){var u=[];if(e&&e.length){u=e}else{if(!e||!e.event){throw\"EventObject must have a event value.\"}var c={event:e.event,attr:e.attr,duration:e.duration,tag:e.tag};u.push(c)}for(var p=0,f=u.length;p<f;p++){u[p].attributes=u[p].attr;delete u[p].attr}var d=\"https://api.leancloud.cn/1.1/stats/open/collect\";var l={client:{id:a.getId(),platform:\"web\",app_version:i,app_channel:r},session:{id:o.getId()},events:u};o.ajax({url:d,method:\"post\",data:l,appId:t,appKey:n},function(e,t){if(s){if(e){s(e)}else{s(t)}}})}}};n.analytics=function(e){if(typeof e!==\"object\"){throw\"AV.analytics need a argument at least.\"}else if(!e.appId){throw\"Options must have appId.\"}else if(!e.appKey){throw\"Options must have appKey.\"}var t=i(e);a.pageView(t);a.sessionView(t);return t};n.analytics.version=t;n.analytics._tool=o;n.analytics._engine=a;a.getId=function(){var t=\"leancloud-analytics-id\";var n=e.localStorage.getItem(t);if(!n){n=o.getId();e.localStorage.setItem(t,n)}return n};a.pageView=function(t){var n;var a;var i;function r(){n=o.now();i=e.location.href}function s(){a=o.now();t.send({event:\"_page\",duration:a-n,tag:i})}r();e.addEventListener(\"hashchange\",function(e){s();r()});e.addEventListener(\"beforeunload\",function(){s()})};a.sessionView=function(t){var n=o.now();e.addEventListener(\"beforeunload\",function(){var e=o.now();t.send({event:\"_session.close\",duration:e-n})})};o.getId=function(){var e=function(){return(new Date).getTime().toString(36)+Math.random().toString(36).substring(2,3)};return\"AV\"+e()+e()+e()};o.ajax=function(e,t){var n=e.url;var o=e.method||\"get\";var a=new XMLHttpRequest;a.open(o,n);if(o===\"post\"||o===\"put\"){a.setRequestHeader(\"Content-Type\",\"application/json\")}if(e.appId){a.setRequestHeader(\"X-AVOSCloud-Application-Id\",e.appId)}if(e.appKey){a.setRequestHeader(\"X-AVOSCloud-Application-Key\",e.appKey)}a.onload=function(e){if(a.status>=200&&a.status<300){t(JSON.parse(a.responseText))}else{t(null,JSON.parse(a.responseText))}};a.onerror=function(e){t(null,e);throw\"Network error.\"};a.send(JSON.stringify(e.data))};o.now=function(){return(new Date).getTime()}}(window);"],"sourceRoot":"/source/"}